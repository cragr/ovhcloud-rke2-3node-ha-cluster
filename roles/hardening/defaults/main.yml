---
# SSH settings
sshd_permit_root_login: "no"
sshd_password_authentication: "no"
sshd_pubkey_authentication: "yes"
sshd_allowed_users:
  - ansible

# Required packages
hardening_packages:
  - ufw
  - fail2ban
  - unattended-upgrades
  - curl
  - tar
  - lvm2
  - open-iscsi
  - nfs-common

# fail2ban settings
fail2ban_bantime: 3600
fail2ban_findtime: 600
fail2ban_maxretry: 5

# UFW settings
ufw_default_incoming: deny
ufw_default_outgoing: allow

# Cloudflare IP ranges (for HTTP/HTTPS)
cloudflare_ipv4_ranges:
  - 173.245.48.0/20
  - 103.21.244.0/22
  - 103.22.200.0/22
  - 103.31.4.0/22
  - 141.101.64.0/18
  - 108.162.192.0/18
  - 190.93.240.0/20
  - 188.114.96.0/20
  - 197.234.240.0/22
  - 198.41.128.0/17
  - 162.158.0.0/15
  - 104.16.0.0/13
  - 104.24.0.0/14
  - 172.64.0.0/13
  - 131.0.72.0/22

# Kernel modules for containers
kernel_modules:
  - br_netfilter
  - overlay

# Sysctl settings for Kubernetes
sysctl_settings:
  net.bridge.bridge-nf-call-iptables: 1
  net.bridge.bridge-nf-call-ip6tables: 1
  net.ipv4.ip_forward: 1
  net.ipv4.conf.all.forwarding: 1
